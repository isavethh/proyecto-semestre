TechMarket AI — Capítulo 14 Analytics, Dashboards y KPIs (decisiones con datos, no con intuición) Propósito del capítulo: convertir los eventos (Cap. 13) y la operación (Cap. 3–12) en información accionable para tres actores: negocio , embajador y plataforma . Sin analytics, TechMarket AI no puede optimizar ranking, monetización ni calidad. Este capítulo define métricas, modelos de datos, dashboards y el pipeline para alimentar todo. 14.1. Principio enterprise: “cada módulo produce señales” En TechMarket AI, cada acción produce eventos: - vistas, clicks, leads, tickets. - SLA, cotizaciones, cierres. - publicaciones, flags, moderación. - pagos, suscripciones, comisiones. El objetivo de analytics es: - medir salud del marketplace, - mejorar conversión, - detectar fraude, - justificar premium. Regla: analytics no puede depender de queries pesadas sobre tablas transaccionales. 14.2. Arquitectura de analytics recomendada 14.2.1 Event collection eventos producidos por módulos (Cap. 13) enviados a un bus / stream 14.2.2 Processing agregación near‑real‑time (simple) batch diario (robusto) 14.2.3 Storage PostgreSQL para agregados diarios (simple y suficiente en MVP) opcional: ClickHouse/BigQuery en escala 14.2.4 Consumption dashboards (web) alertas ranking model MVP pragmático: agregados diarios en Postgres + jobs. 14.3. Dashboards por actor 14.3.1 Dashboard Negocio (tenant) Objetivo: ayudar a convertir y operar. Métricas core: - visitas al perfil - vistas de listings - clicks WhatsApp - leads por estado - tasa de conversión (WON) - tiempo de primera respuesta - tickets creados / resueltos - cotizaciones emitidas / aprobadas - reseñas y reputación 14.3.2 Dashboard Embajador Objetivo: motivar con impacto verificable. Métricas core: - negocios registrados - verificados - activados - premium - ingresos estimados - payout por ciclo 14.3.3 Dashboard Plataforma (admin) Objetivo: controlar salud, fraude y crecimiento. Métricas core: - MAU/DAU - retención 7/30 días - funnels (view→click→lead→win) - oferta por zona (densidad) - tiempos de respuesta promedio - tasa de fraude/reports - revenue por segmento - churn premium 14.4. KPIs clave (los que verdaderamente importan) 14.4.1 KPIs de adquisición nuevos usuarios nuevos tenants verificación rate 14.4.2 KPIs de activación tenants con al menos N listings tenants que responden leads 14.4.3 KPIs de conversión CTR mapa/lista click-to-lead lead-to-win ticket-to-quote-approved 14.4.4 KPIs de calidad SLA first response SLA resolution dispute rate report rate 14.4.5 KPIs financieros MRR premium ARPA tenant revenue performance payout ratio 14.5. Funnel estándar (para medir todo) Definimos un funnel base: 1) VIEW (map/listing) 2) CLICK (WhatsApp/CTA) 3) LEAD_CREATED 4) QUOTED 5) WON Para servicios: 1) TICKET_CREATED 2) QUOTE_SENT 3) QUOTE_APPROVED 4) TICKET_CLOSED Beneficio: puedes comparar negocios, zonas y campañas. 14.6. Modelo de datos (read model analytics) 14.6.1 Principio No uses tablas transaccionales para dashboard. Crea tablas de agregados. 14.6.2 PostgreSQL (agregados diarios) Tablas recomendadas: analytics_tenant_daily tenant_id , day profile_views , listing_views , whatsapp_clicks leads_created , leads_won tickets_created , tickets_closed avg_first_response_min , avg_resolution_hours analytics_branch_daily branch_id , day métricas por sucursal analytics_campaign_daily campaign_id , day impressions , clicks , leads , wins analytics_ambassador_daily ambassador_id , day tenants_registered , tenants_verified , premium_activated commission_estimated analytics_platform_daily day dau , mau , new_users , new_tenants , mrr , fraud_cases 14.6.3 MongoDB analytics_raw_events_archive (opcional) 14.6.4 Redis cache dashboards por sesión. 14.7. Cálculo de métricas (cómo se alimenta) 14.7.1 Recolección eventos entran a outbox → bus (Cap. 13) 14.7.2 Procesamiento diario Un job nocturno: - consume eventos del día - agrega por tenant/branch/campaign - actualiza tablas analytics 14.7.3 Procesamiento near‑real‑time Opcional: - contadores en Redis para “hoy” - al final del día se consolidan MVP: batch diario es suficiente. 14.8. Alertas (analytics que actúa) 14.8.1 Alertas operacionales lead sin respuesta &gt; X horas ticket en espera &gt; Y días 14.8.2 Alertas de fraude spikes de reseñas múltiples tenants con mismo patrón 14.8.3 Alertas financieras churn premium fallas de pago Las alertas se envían vía notificaciones (Cap. 13). 14.9. Visualizaciones recomendadas (sin sobrecargar) Negocio tarjetas KPI (hoy/semana/mes) embudo mapa de calor por horario de leads ranking de listings Embajador progreso por meta payouts conversion rate de su red Plataforma oferta vs demanda por zona cohort retention revenue breakdown 14.10. APIs Negocio GET /analytics/tenant/daily?from=&amp;to= GET /analytics/tenant/funnel?from=&amp;to= Embajador GET /analytics/ambassador/daily?from=&amp;to= Plataforma GET /analytics/platform/daily?from=&amp;to= GET /analytics/platform/fraud 14.11. Implementación (paso a paso) Paso 1 — Definir eventos base view, click, lead, ticket, quote. Paso 2 — Tablas analytics agregados diarios por actor. Paso 3 — Processor batch job nocturno. idempotencia por día. Paso 4 — Dashboards web componentes KPI. filtros de fecha. Paso 5 — Alertas reglas y notificaciones. 14.12. Pruebas y definición de “listo” Casos esenciales vista listing incrementa contador. click WhatsApp incrementa. lead creado impacta funnel. dashboard refleja datos del día anterior. Listo significa negocio ve valor medible. embajador ve progreso. plataforma toma decisiones. 14.13. Conexión con el Capítulo 15 Con analytics listo, toca diseñar el módulo de: - Gestión del negocio (panel web/móvil) completo: roles internos, sucursales, catálogo, tickets, CRM y configuración. Fin del Capítulo 14
